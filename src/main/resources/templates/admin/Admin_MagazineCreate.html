<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=, initial-scale=1.0">
    <title>매거진 관리 | 매거진 등록</title>
    <link rel="stylesheet" href="/admin/css/style.css">
    <script
    src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
    crossorigin="anonymous">
    </script>
    <script src="/static/admin/js/Admin.cate.js"></script>
    <script src="/admin/js/popup.js"></script>
    <script src="/admin/js/Admin.imeage.js"></script>
    <script type="text/javascript" src="/admin/ckeditor/ckeditor.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
            function sendit(){
                alert("소민이바보")
                let type = $('#MC_type_hidden').val()
                let title = $('#title').val()
                let des = $('#des').val()
                let content = CKEDITOR.instances.textarea.getData();

                axios.post("/api/magazine/create/", {
                    data:{
                        type : type,
                        title : title,
                        des : des,
                        img : "uploads/file",
                        content : content,
                        showFlag : 1,
                    }
                }).then(function (){
                    alert("매거진 등록에 성공했습니다")
                    $.ajax({
                        type:"GET",
                        url : "admin/Admin_MagazineCreate.html",
                        datatype : "html/text",
                        success: function(result){
                            $("#content").html(result).trigger("create");
                        }
                    });
                }).catch(function (err){
                    console.log(err)
                })
            }

            function sendsc(){
                $(".MCT_c3_p_list > tbody").empty()
                let state =[];
                state.push($("input:checkbox[name='notice']:checked").val());
                let cateIdx = $("#PL_sel").val()
                let name = $("#MCT_c3_scName").val()

                let tb;
                alert("소민이바보")
                axios.get("/api/product/list?state="+state+"&cateIdx="+cateIdx+"&name="+name+"&id=?",{
                }).then(function (response){
                    for(let i in response){
                        let $id = response[i].data.id;
                        let $img = response[i].data.img;
                        let $title = response[i].data.title;
                        let $state = response[i].data.state;

                        let row = $('<tr>').append(
                            '<td><td><input type="checkbox" class="cou_list" name="mc_list" id="McT_check"+(i+9) value='+$id+'><label for="McT_check"+(i+9)></td>' +
                            '<td><img src="'+$img+'"></td>'+
                            '<td>' + $title + '</td>' +
                            '<td>' + $state + '</td>'
                        )
                        tb.append(row)
                    }
                    $("#tbody").after(tb);
                })
            }

            function sendpd(){

                let tr=[];
                $("input:checkbox[name='mc_list']:checked").each(function(e) {
                    tr.push(this.parentNode.parentNode);
                })
                console.log(tr)

                for(let i in tr){
                    let $id = $(tr[i]).children().eq(0).children().val()
                    let $img = $(tr[i]).children().eq(1).children().attr("src")
                    let $title = $(tr[i]).children().eq(2).text();
                    console.log($img)
                    console.log($title)

                    let row = $('<div>').append(
                        '<input type="hidden" value="'+$id+'" class="mc_hidden">' +
                        '<img src="'+$img+'">' +
                        '<p>'+$title+'</p></div>'
                    )
                    $('.MCT_c3_proBox').append(row)
                }
                alert("소민이바보")
            }

            $(function (){
                let tb;
                axios.get("/api/product/read",{
                }).then(function (response){
                    for(let i in response){
                        let $id = response[i].data.id;
                        let $img = response[i].data.img;
                        let $title = response[i].data.title;
                        let $state = response[i].data.state;
                        let k = parseInt(i) + 9

                        let row = $('<tr>').append(
                            '<td><input type="checkbox" class="cou_list" name="mc_list" id="McT_check_"'+k+'value='+$id+'><label for="McT_check_"'+k+'></td>' +
                            '<td><img src="'+$img+'"></td>'+
                            '<td>' + $title + '</td>' +
                            '<td>' + $state + '</td>'
                        )
                        tb.append(row)
                    }
                    $("#tbody").after(tb);
                })
            })

            $(function (){
                $('#MC_click_box > a').click(function (e){
                    $('#MC_type_hidden').val(($(this).children("input").val()));
                })
            })
    </script>
</head>
<body>
    <!--content_title 시작-->
    <div class="content_title"><p>매거진 관리<span>매거진 등록</span></p></div>            
    <!--content_title 끝-->
    <!--MCreaTe 시작-->
    <div class="MCreaTe"> <!--이하 MCT--> 
        <!--MCT_c1 시작-->
        <div class="content_title_click" id="MC_click_box">
            <a id="MC_click_1"><input type="hidden" value="NOTE">탐험노트</a>
            <a id="MC_click_2"><input type="hidden" value="STYLE">라이프스타일</a>
            <a id="MC_click_3"><input type="hidden" value="GUIDE">키친가이드</a>
            <input type="hidden" id="MC_type_hidden">
        </div>
        <!--MCT_c1 끝-->
        <!--MCT_c2 시작-->
        <div>
            <input type="hidden" id="MCT_catevalue" value="null">
            <div class="MCT_c2">
                <p class="product_title_s" id="MCT_c1_title"><label>매거진 등록</label></p>
                <div class="MCT_c2_regist">
                    <div id="MCT_c2_imgbox">
                        <span>이미지</span>
                        <img src=" " id="MCT_c2_img">
                        <!--등록 이미지 들어가는 곳-->
                        <div class="MCT_c2_Btnbox">
                            <div class="file_input_div_t">
                                <input type="button" value="파일 등록" class="file_input_button_t">
                                <input type="file" class="file_input_hidden_t" id="MCT_c2_imgbtn">
                            </div>
                        </div>
                    </div>    
                    <div class="MCT_c2_write">
                        <p><span>제목</span><input type="text" id="title"></p>
                        <p><span>설명</span><input type="text" id="des"></p>
                    </div>
                </div>
            </div>
            <!--MCT_c2 끝-->
            <!--MCT_c3 시작-->
            <div class="MCT_c3">
                <span class="html_add"><span class="options">*(선택사항)</span>html + 상품 항목</span>
                <!-- <div class="MCT_c3_add">
                    <select id="MCT_c3_select">
                        <option value="html">HTML</option>
                        <option value="product">상품</option>
                    </select>
                    <input type="button" value="추가" id="MCT_C3_addbtn" onclick="addHtml()">
                    <input type="button" value="삭제" id="MCT_C3_delbtn">
                </div>
                <html/상품 항목 추가 script 시작-->
                <!-- <script>
                    let i = 1;
                    let j = 1;
                    const addHtml = function(){
                        let seleted = document.getElementById("MCT_c3_select");
                        let seleted_value = seleted.options[seleted.selectedIndex].value;
                        if(seleted_value == 'html'){
                            $(".MCT_c3_editlist").append
                        ("<div class='MCT_c3_htmllist' id='MCT_c3_html_"+i+"'>"
                            +"<div class='create_html'><span>HTML- 항목"+i+"</span><span class='MCT_c3_img><img src=''></span></div>"
                            +"<textarea id='MCT_c3_html_text_"+i+"' class='textarea' name='textarea'>"
                            +"</textarea>"
                        +"</div>")
                        i++;
                        }
                        else{
                            $(".MCT_c3_editlist").append
                            ("<div class='content2_2_productllist' id='content_2_2_con_4_product_"+j+"'><div><span>상품- 항목"+j+"</span></div><a><img scr=''></a><a><img src=''></a><p>상품목록<input type='button' value='추가'></p><div id='content_2_2_con_3_product_list"+j+"'></div></div>")
                        j++;    
                        }
                        
                    };
                </script> -->
                <!-- html/상품 항목 추가 생성 script 끝-->
                <div class="MCT_c3_editlist">
                    <div class='MCT_c3_htmllist'>
                        <div class='create_html'><span>HTML</span></div>
                        <textarea class='textarea' name='textarea'></textarea>
                    </div>
                    <script type="text/javascript">
                        CKEDITOR.replace('textarea'
                                    , {height: 300                                                  
                                });
                    </script>
                    <div class='MCT_c3_prodlist'>
                        <div class='create_prod'><span>상품</span></div>
                        <div class='MCT_c3_prodTitle'><p>상품 목록</p></div>
                        <div class='MCT_c3_proBox'></div>
                        <!-- pageBox 시작-->
                        <div class="pageBox">
                            <ul>
                                <li id="Maxprev"><a href="#"><<</a></li>
                                <li><a href="#"><</a></li>
                                <li><a href="#">1</a></li>
                                <li><a href="#">2</a></li>
                                <li><a href="#">></a></li>
                                <li id="Maxnext"><a href="#">>></a></li>
                            </ul>
                        </div>
                        <!-- pageBox 끝-->
                        <div class='MCT_c3_addTitle'>
                            <p>상품추가<span> + 원하는 상품을 추가해주세요</span></p>
                        </div>
                        <div class='MCT_c3_addlist'>
                            <table border="1px" class='MCT_c3_scbox'>
                                <tr height="70">
                                    <th width="150">상품분류</th>
                                    <td>
                                        <select onchange="categoryChange(this)">
                                            <option value="대분류">대분류</option>
                                            <option value="과일">과일</option>
                                            <option value="채소">채소</option>
                                            <option value="쌀·잡곡·견과">쌀·잡곡·견과</option>
                                            <option value="정육·계란">정육·계란 </option>
                                            <option value="수산·건어물">수산·건어물</option>
                                            <option value="국·반찬·요리">국·반찬·요리</option>
                                            <option value="간편식·샐러드">간편식·샐러드</option>
                                            <option value="양념·오일·면">양념·오일·면</option>
                                            <option value="베이커리·유제품">베이커리·유제품</option>
                                            <option value="커피·음료·간식">커피·음료·간식</option>
                                            <option value="생활·선물세트">생활·선물세트</option>
                                        </select>
                                        <select id="PL_sel">
                                            <option value="중분류">중분류</option>
                                        </select>
                                        <script>
                                            function categoryChange(e) {
                                                var PL_sel_1 = ["시즌한정과일", "국산과일", "수입과일", "간편과일", "냉동·건과일"];
                                                var PL_sel_2 = ["필수채소", "반찬채소", "뿌리채소", "쌈·샐러드", "간편채소", "버섯류"];
                                                var PL_sel_3 = ["쌀", "잡곡", "견과"];
                                                var PL_sel_4 = ["소고기", "돼지고기", "닭·오리고기", "양고기", "계란류", "양념육·가공육", "햄·소시지·베이컨", "본앤브래드"];
                                                var PL_sel_5 = ["시즌한정수산·회", "생선류", "오징어·낙지·문어", "새우·게·랍스터", "전복·조개류", "김·미역·해조류", "멸치·건어물", "간편수산물"];
                                                var PL_sel_6 = ["반찬", "국·찌개·탕", "김치·장아찌·젓갈", "두부·어묵·냉장식품", "만두·튀김·냉동식품"];
                                                var PL_sel_7 = ["밀키트", "샐러드·도시락", "밥·면·즉석식품", "떡볶이·핫도그·냉동간식", "떡", "시리얼·바·선식", "죽·수프·퓨레"];
                                                var PL_sel_8 = ["소스·드레싱·육수", "장·식초·액젓", "소금·향신료·설탕·꿀", "오잉·참기름·식용유", "파스타·면", "밀가루·가루·믹스", "통조림·병조림"];
                                                var PL_sel_9 = ["식빵·빵류", "케이크·파이·디저트류", "치즈·버터·잼", "우유·두유·요거트"];
                                                var PL_sel_10 = ["커피", "차", "주스", "음료·즙", "생수·탄산수", "아이스크림", "과자류", "캔디·젤리·초콜릿"];
                                                var PL_sel_11 = ["주방용품", "생활·위생용품", "가전제품", "건강식품", "선물세트"];
                                                var target = document.getElementById("PL_sel");
                
                                                if(e.value == "과일") var d = PL_sel_1;
                                                else if(e.value == "채소") var d = PL_sel_2;
                                                else if(e.value == "쌀·잡곡·견과") var d = PL_sel_3;
                                                else if(e.value == "정육·계란") var d = PL_sel_4;
                                                else if(e.value == "수산·건어물") var d = PL_sel_5;
                                                else if(e.value == "국·반찬·요리") var d = PL_sel_6;
                                                else if(e.value == "간편식·샐러드") var d = PL_sel_7;
                                                else if(e.value == "양념·오일·면") var d = PL_sel_8;
                                                else if(e.value == "베이커리·유제품") var d = PL_sel_9;
                                                else if(e.value == "커피·음료·간식") var d = PL_sel_10;
                                                else if(e.value == "생활·선물세트") var d = PL_sel_11;
                                                target.options.length = 0;
                
                                                for (x in d) {
                                                    var opt = document.createElement("option");
                                                    opt.value = d[x];
                                                    opt.innerHTML = d[x];
                                                    target.appendChild(opt);
                                                }
                                            }
                                        </script>
                                    </td>
                                </tr>
                                <tr height="70">
                                    <th>판매상태</th>
                                    <td>
                                        <input type="checkbox" name="d_status2" value="all" id="MCT_c3_check_1"><label for="MCT_c3_check_1">전체</label>
                                        <label><input type="checkbox" name="d_status2" value="ing" id="MCT_c3_check_2"><label for="MCT_c3_check_2">정상판매</label>
                                        <label><input type="checkbox" name="d_status2" value="stop" id="MCT_c3_check_3"><label for="MCT_c3_check_3">판매중지</label>
                                        <label><input type="checkbox" name="d_status2" value="sold" id="MCT_c3_check_4"><label for="MCT_c3_check_4">품절</label>
                                    </td>
                                </tr>
                                <tr height="70">
                                    <th>정렬</th>
                                    <td>
                                    <input type="checkbox" id="MCT_c3_check_5"><label for="MCT_c3_check_5">최근등록순</label>
                                    <input type="checkbox" id="MCT_c3_check_6"><label for="MCT_c3_check_6">등록오랜순</label>
                                    <input type="checkbox" id="MCT_c3_check_7"><label for="MCT_c3_check_7">높은가격순</label>
                                    <input type="checkbox" id="MCT_c3_check_8"><label for="MCT_c3_check_8">낮은가격순</label>
                                    </td>
                                </tr>
                                <tr height="70">
                                    <th>상품명</th>
                                    <td>
                                        <input type="text" placeholder="상품명을 입력해주세요" id="MCT_c3_scName">
                                        <input type="button" value="검색" id="MCT_c3_scbtn" onclick="sendsc()">
                                    </td>
                                </tr>
                            </table>
                            <div class="bottom_btn" id="MCT_btnBox">
                                <span><input type="button" name="button" value="추가" onclick="sendpd()"></span>
                            </div>
                            <table width="100%" style="text-align: center;" class="MCT_c3_p_list">
                                <thead>
                                    <tr id="tbody">
                                        <th width="7%" height="40px"><input type="checkbox" value="cou_list" id="MCT_c3_check" name="selectall" onclick="MC_selectAll(this)"><label for="MCT_c3_check"></th>
                                        <th width="40%">상품 이미지</th>
                                        <th width="28%">상품명</th>
                                        <th width="25%">판매상태</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td height="80px"><input type="checkbox" name="mc_list" id="MCT_c3_check_10" onclick="MC_checkSelectAll()"><label for="MCT_c3_check_10"></label></td>
                                        <td><img src="/admin/img/down.png">예시</td>
                                        <td>예시</td>
                                        <td>예시</td>
                                    </tr>
                                    <tr>
                                        <td height="80px"><input type="checkbox" name="mc_list" id="MCT_c3_check_11" onclick="MC_checkSelectAll()"><label for="MCT_c3_check_11"></label></td>
                                        <td><img src="/admin/img/up.png">예시</td>
                                        <td>예시</td>
                                        <td>예시</td>
                                    </tr>
                                    <tr>
                                        <td height="80px"><input type="checkbox" name="mc_list" id="MCT_c3_check_12" onclick="MC_checkSelectAll()"><label for="MCT_c3_check_12"></label></td>
                                        <td><img src="">예시</td>
                                        <td>예시</td>
                                        <td>예시</td>
                                    </tr>
                                    <tr>
                                        <td height="80px"><input type="checkbox" name="mc_list" id="MCT_c3_check_13" onclick="MC_checkSelectAll()"><label for="MCT_c3_check_13"></label></td>
                                        <td><img src="">예시</td>
                                        <td>예시</td>
                                        <td>예시</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="pageBox" id="MC_c2_pageBox">
                                <ul>
                                    <li id="Maxprev"><a href="#"><<</a></li>
                                    <li><a href="#"><</a></li>
                                    <li><a href="#">1</a></li>
                                    <li><a href="#">2</a></li>
                                    <li><a href="#">></a></li>
                                    <li id="Maxnext"><a href="#">>></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--MCT_c3 끝-->
            <div id="MC_c3_btnBox" class="bottom_btn">
                <input type="button" name="submit" value="등록하기" onclick="sendit()">
            </div>
        </div>
    </div>
    <!--MCreaTe 끝-->
    <!--MCT_popup 시작-->
        <!--문제점 추가 눌렀을 때마다 다른 아이디 값의 팝업이 떠야함 즉 클래스를 생성해야하만 함-->
        <!--팝업을 안썼더라도 만들었어야함-->
    <!--MCT_popup 끝-->
</body>
</html>